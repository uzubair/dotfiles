# Helper functions

# AWS SSO login
function au() {
    AWS_PROFILE=default aws sso login
}

# Sets the AWS_PROFILE and K8s current context
function st () {
    if [[ $(aws configure --profile $1 list) && $? -eq 0 ]]; then
        echo "\e[92mAssuming AWS profile \"$1\"."
    else
        echo "\e[91mAWS profile \"$1\" does not exist. Exiting."
        return 1
    fi
    AWS_PROFILE=$1 && export AWS_PROFILE
    if [[ "$1" == "qap-dev" ]]; then
        kubectx legacy-dev
    elif [[ "$1" == "coreip-dev" ]]; then
        kubectx coreip-dev-2
    elif [[ "$1" == "mio-master" ]]; then
    else
        kubectx $1
    fi
}

# Resets the following env:
# - AWS Profile
# - K8S current config
function st-() {
    if [[ $(kubectl config unset current-context) && $? -eq 0 ]]; then
        unset AWS_PROFILE
    else
        echo "\e[91mUnable to reset the env. Exiting."
    fi
}
